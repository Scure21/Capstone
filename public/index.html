<html>
<head>
  <meta charset="UTF-8">
  <script language="javascript" type="text/javascript" src="p5.js"></script>
  <!-- uncomment lines below to include extra p5 libraries -->
  <!--<script language="javascript" src="libraries/p5.dom.js"></script>-->
  <!--<script language="javascript" src="libraries/p5.sound.js"></script>-->
  <script language="javascript" type="text/javascript" src="food.js"></script>
  <script language="javascript" type="text/javascript" src="snake.js"></script>
  <script language="javascript" type="text/javascript" src="sketch.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <!-- this line removes any default padding and style. you might only need one of these values set. -->
  <style> body {padding: 0; margin: 0;} </style>
</head>

<body>
  <script>
    var socket = io.connect('http://192.168.1.184:1337');
    var device;
    //device =  /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
    device = window.navigator.userAgent
    socket.emit('mobile-device', device)
    socket.on('activate-device-controls', function (connected) {
      if(connected){
        console.log('YES YOU ARE CONNECTED WITH A MOBILE DEVICE')
        var snake_position = {
              x: 0,
              y: 0
            },
            emit_updates = function(){
              socket.emit('snake_position_change', snake_position);
            }
            touchstart = function(e){
              console.log('THIS IS E', e)
              e.preventDefault();
              var touch = touchStarted()
              if (e){
               snake_position.event = touchStarted()
              }
              emit_updates();
            },
            touchend = function(e){
              e.preventDefault();
              snake_position.event = e;
              emit_updates();
            },
            devicemotion = function(e){
              snake_position.event = e;
              emit_updates();
            }
            document.body.addEventListener('touchstart', touchstart, false); // iOS & Android
            document.body.addEventListener('MSPointerDown', touchstart, false); // Windows Phone
            document.body.addEventListener('touchend', touchend, false); // iOS & Android
            document.body.addEventListener('MSPointerUp', touchend, false); // Windows Phone
            window.addEventListener('devicemotion', devicemotion, false);

          } else {
            // Failed connection
            alert("Not connected!");
          }
        })
  </script>
</body>
</html>
